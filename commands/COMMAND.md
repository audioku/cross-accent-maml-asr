# single training


# joint-training
CUDA_VISIBLE_DEVICES=0 python3 joint_train.py --train-manifest-list data/manifests/cv-valid-train_manifest.csv data/manifests/hkust_16khz_train_manifest.csv --valid-manifest-list data/manifests/cv-valid-dev_manifest.csv data/manifests/hkust_16khz_dev_manifest.csv data/manifests/seame_phaseII_val_manifest.csv --cuda --k-train 8 --labels-path data/labels/hkust_seame_labels.json --lr 1e-4 --name joint_cv_hkust_enc2_dec4_512_b8_16khz --save-folder save/ --save-every 5000 --feat_extractor vgg_cnn --dropout 0.1 --num-enc-layers 2 --num-dec-layers 4 --num-heads 8 --dim-model 512 --dim-key 64 --dim-value 64 --dim-input 5120 --dim-inner 512 --dim-emb 512 --early-stop cer,200 --src-max-len 5000 --tgt-max-len 2500 --evaluate-every 1000 --epochs 10000000 --sample-rate 16000

CUDA_VISIBLE_DEVICES=3 python3 joint_train.py --train-manifest-list data/manifests/cv-valid-train_manifest.csv data/manifests/hkust_16khz_train_manifest.csv data/manifests/seame_phaseII_train_manifest.csv --valid-manifest-list data/manifests/cv-valid-dev_manifest.csv data/manifests/hkust_16khz_dev_manifest.csv data/manifests/seame_phaseII_val_manifest.csv --cuda --k-train 8 --labels-path data/labels/hkust_seame_labels.json --lr 1e-4 --name joint_cv_hkust_seame_enc2_dec4_512_b8_16khz --save-folder save/ --save-every 5000 --feat_extractor vgg_cnn --dropout 0.1 --num-enc-layers 2 --num-dec-layers 4 --num-heads 8 --dim-model 512 --dim-key 64 --dim-value 64 --dim-input 5120 --dim-inner 512 --dim-emb 512 --early-stop cer,200 --src-max-len 5000 --tgt-max-len 2500 --evaluate-every 1000 --epochs 10000000 --sample-rate 16000

# meta-training
<!-- CUDA_VISIBLE_DEVICES=3 python3 meta_train.py --train-manifest-list data/manifests/cv-valid-train_manifest.csv data/manifests/hkust_16khz_train_manifest.csv --valid-manifest-list data/manifests/cv-valid-dev_manifest.csv data/manifests/hkust_16khz_dev_manifest.csv --cuda --k-train 4 --k-valid 4 --labels-path data/labels/hkust_seame_labels.json --lr 1e-4 --name meta_cv_hkust_enc2_dec4_512_16khz --save-folder save/ --save-every 1000 --feat_extractor vgg_cnn --dropout 0.1 --num-enc-layers 2 --num-dec-layers 4 --num-heads 8 --dim-model 512 --dim-key 64 --dim-value 64 --dim-input 5120 --dim-inner 512 --dim-emb 512 --early-stop cer,200 --src-max-len 5000 --tgt-max-len 2500 --evaluate-every 1000 --epochs 100000 --sample-rate 16000 -->

CUDA_VISIBLE_DEVICES=2 python3 meta_train.py --train-manifest-list data/manifests/cv-valid-train_manifest.csv data/manifests/hkust_16khz_train_manifest.csv --valid-manifest-list data/manifests/cv-valid-dev_manifest.csv data/manifests/hkust_16khz_dev_manifest.csv data/manifests/seame_phaseII_val_manifest.csv --cuda --k-train 8 --k-valid 8 --labels-path data/labels/hkust_seame_labels.json --lr 1e-4 --name meta_cv_hkust_enc2_dec4_512_b8_16khz_copy_grad --save-folder save/ --save-every 5000 --feat_extractor vgg_cnn --dropout 0.1 --num-enc-layers 2 --num-dec-layers 4 --num-heads 8 --dim-model 512 --dim-key 64 --dim-value 64 --dim-input 5120 --dim-inner 512 --dim-emb 512 --early-stop cer,200 --src-max-len 5000 --tgt-max-len 2500 --evaluate-every 1000 --epochs 1000000 --sample-rate 16000 --copy-grad

# analyse dataset
CUDA_VISIBLE_DEVICES=7 python3 analyze.py \
--train-manifest-list data/manifests/libri_train_manifest.csv data/manifests/cv-valid-train_manifest.csv data/manifests/seame_phaseII_train_manifest.csv data/manifests/seame_phaseII_8khz_train_manifest.csv data/manifests/hkust_16khz_train_manifest.csv \
--valid-manifest-list data/manifests/libri_val_manifest.csv  data/manifests/cv-valid-dev_manifest.csv data/manifests/seame_phaseII_val_manifest.csv data/manifests/seame_phaseII_8khz_val_manifest.csv data/manifests/hkust_16khz_val_manifest.csv \
--test-manifest-list data/manifests/libri_test_clean_manifest.csv data/manifests/cv-valid-test_manifest.csv data/manifests/seame_phaseII_test_manifest.csv data/manifests/seame_phaseII_8khz_test_manifest.csv \
--labels-path data/labels/hkust_seame_labels.json --cuda --batch-size 64 --lr 1e-4 --name data_analysis --save-folder save/ --save-every 10 --feat_extractor vgg_cnn --dropout 0.1 --num-enc-layers 4 --num-dec-layers 4 --num-heads 8 --dim-model 512 --dim-key 64 --dim-value 64 --dim-input 5120 --dim-inner 512 --dim-emb 512 --early-stop cer,200 --src-max-len 5000 --tgt-max-len 2500 --evaluate-every 1000

# samcah | 3 datasets meta_cv_hkust_seame_enc2_dec4_512_b8_16khz_copy_grad
CUDA_VISIBLE_DEVICES=0 python3 meta_train.py --train-manifest-list data/manifests/cv-valid-train_manifest.csv data/manifests/hkust_16khz_train_manifest.csv data/manifests/seame_phaseII_train_manifest.csv --valid-manifest-list data/manifests/cv-valid-dev_manifest.csv data/manifests/seame_phaseII_val_manifest.csv data/manifests/hkust_16khz_dev_manifest.csv --labels-path data/labels/hkust_seame_labels.json --cuda --k-train 8 --k-valid 8 --lr 1e-4 --name meta_cv_hkust_seame_enc4_dec6_512_b8_16khz_copy_grad --save-folder save/ --save-every 3000 --feat_extractor vgg_cnn --dropout 0.1 --num-enc-layers 4 --num-dec-layers 6 --num-heads 8 --dim-model 512 --dim-key 64 --dim-value 64 --dim-input 5120 --dim-inner 512 --dim-emb 512 --early-stop cer,200 --src-max-len 5000 --tgt-max-len 2500 --epochs 100000000 --evaluate-every 1000  --sample-rate 16000 --copy-grad 2>&1

CUDA_VISIBLE_DEVICES=1 python3 meta_train.py --train-manifest-list data/manifests/cv-valid-train_manifest.csv data/manifests/hkust_16khz_train_manifest.csv data/manifests/seame_phaseII_train_manifest.csv --valid-manifest-list data/manifests/cv-valid-dev_manifest.csv data/manifests/hkust_16khz_dev_manifest.csv data/manifests/seame_phaseII_val_manifest.csv --labels-path data/labels/hkust_seame_labels.json --cuda --k-train 8 --k-valid 8 --lr 1e-4 --name meta_cv_hkust_seame_enc2_dec4_512_b8_16khz_copy_grad --save-folder save/ --save-every 3000 --feat_extractor vgg_cnn --dropout 0.1 --num-enc-layers 2 --num-dec-layers 4 --num-heads 8 --dim-model 512 --dim-key 64 --dim-value 64 --dim-input 5120 --dim-inner 512 --dim-emb 512 --early-stop cer,200 --src-max-len 5000 --tgt-max-len 2500 --epochs 100000000 --evaluate-every 1000  --sample-rate 1600

# transient training
CUDA_VISIBLE_DEVICES=1 python3 transient_train.py --train-manifest-list data/manifests/cv-valid-train_manifest.csv data/manifests/hkust_16khz_train_manifest.csv data/manifests/seame_phaseII_train_manifest.csv --valid-manifest-list data/manifests/cv-valid-dev_manifest.csv data/manifests/hkust_16khz_dev_manifest.csv data/manifests/seame_phaseII_val_manifest.csv --labels-path data/labels/hkust_seame_labels.json --cuda --k-train 8 --k-valid 8 --lr 1e-4 --name transient_cv_hkust_seame_enc2_dec4_512_b8_16khz_copy_grad --save-folder save/ --save-every 3000 --feat_extractor vgg_cnn --dropout 0.1 --num-enc-layers 2 --num-dec-layers 4 --num-heads 8 --dim-model 512 --dim-key 64 --dim-value 64 --dim-input 5120 --dim-inner 512 --dim-emb 512 --early-stop cer,200 --src-max-len 5000 --tgt-max-len 2500 --epochs 100000000 --evaluate-every 1000  --sample-rate 16000 --copy-grad0
